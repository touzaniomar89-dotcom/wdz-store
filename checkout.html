<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WDZâ„¢ | Secure Checkout</title>
<meta name="theme-color" content="#0a0a0a">
<meta property="og:title" content="WDZâ„¢ | Secure Checkout">
<meta property="og:description" content="Ø¥ØªÙ…Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù† ÙˆØ³Ø±ÙŠØ¹ Ù…Ø¹ WDZâ„¢">
<meta property="og:type" content="website">
<meta property="og:locale" content="ar_MA">
<meta property="og:image" content="https://via.placeholder.com/1200x630.png?text=WDZ%E2%84%A2+Global+Brand">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='28' fill='%23ff1e1e'/%3E%3Ctext x='50%' y='58%' dominant-baseline='middle' text-anchor='middle' font-size='36' fill='white'%3EWDZ%3C/text%3E%3C/svg%3E">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Cairo','Poppins',sans-serif;}
:root{
  --bg:#0B0B0B;
  --bg2:#262b25;
  --accent:#bcfd4c;
  --neutral:#6e6e6e;
  --text:#FFFFFF;
  --radius:18px;
}

body{
background:radial-gradient(1200px 600px at 20% 0,#141414 0,var(--bg) 60%) var(--bg);
color:var(--text);
display:flex;
justify-content:center;
padding:50px 20px;
}

.container{width:100%;max-width:720px;}

h2{text-align:center;margin-bottom:30px;font-weight:800}

.card{
background:var(--bg2);
padding:35px;
border-radius:18px;
box-shadow:0 25px 60px rgba(188,253,76,.18);
margin-bottom:30px;
}

.summary{
background:#161616;
padding:20px;
border-radius:12px;
margin-top:15px;
line-height:1.8;
}

input,select,textarea{
width:100%;
padding:15px;
margin-bottom:18px;
border:none;
border-radius:14px;
background:#161616;
color:var(--text);
font-size:15px;
}

input:focus,select:focus,textarea:focus{
outline:2px solid var(--accent);
}

button{
width:100%;
padding:18px;
background:var(--accent);
border:none;
border-radius:14px;
color:#0B0B0B;
font-weight:700;
font-size:16px;
cursor:pointer;
transition:.3s;
}

button:hover{filter:saturate(120%);}
button:disabled{background:#555;}

.total{
font-size:20px;
font-weight:800;
color:var(--accent);
margin-top:10px;
}

.trust{
text-align:center;
font-size:13px;
opacity:.7;
margin-top:15px;
line-height:1.7;
}

.empty{
text-align:center;
font-size:20px;
margin-top:120px;
}
</style>
<style>
input#phone{direction:ltr;text-align:left}
</style>
</head>

<body>

<div class="container">

<h2>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù…Ù†</h2>

<div id="summary-card" class="card">
<h3>Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨</h3>
<div id="order-summary" class="summary"></div>
<div style="display:flex;justify-content:space-between;margin-top:10px"><span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ</span><strong id="co-sub">0 MAD</strong></div>
<div style="display:flex;justify-content:space-between;margin-top:6px"><span>Ø§Ù„Ø´Ø­Ù†</span><strong id="co-ship">30 MAD</strong></div>
<div class="total" id="total-price"></div>
</div>

<div class="card">
<h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>

<form id="checkout-form">

<input type="text" id="name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required>
<input type="tel" id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required inputmode="numeric" autocomplete="tel" maxlength="16">
<small id="phone-help" style="display:block;opacity:.7;margin-top:-10px;margin-bottom:12px;font-size:12px">ÙŠØ¯Ø¹Ù…: 0XXXXXXXXX Ø£Ùˆ +212XXXXXXXXX Ø£Ùˆ 212XXXXXXXXX â€” ÙŠØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.</small>

<select id="city" required>
<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</option>
<option>Ø§Ù„Ø¯Ø§Ø± Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡</option>
<option>Ø§Ù„Ø±Ø¨Ø§Ø·</option>
<option>Ù…Ø±Ø§ÙƒØ´</option>
<option>ÙØ§Ø³</option>
<option>Ø·Ù†Ø¬Ø©</option>
<option>Ø£ÙƒØ§Ø¯ÙŠØ±</option>
<option>Ø¨Ù†ÙŠ Ù…Ù„Ø§Ù„</option>
</select>

<input type="text" id="address" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„" required>

<!-- quantity selection removed per request -->

<!-- color selection removed per request -->

<!-- note removed per request -->

<button type="submit" id="submit-btn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
<p id="msg" style="text-align:center;margin-top:10px;"></p>

<div class="trust">
ğŸšš ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹ 24-72 Ø³Ø§Ø¹Ø©<br>
ğŸ’° Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…<br>
ğŸ”’ ØªØ´ÙÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªÙ‚Ø¯Ù…
</div>

</form>
</div>

</div>

<script>
const cart = JSON.parse(localStorage.getItem("cart")) || [];
const summary = document.getElementById("order-summary");
const totalPrice = document.getElementById("total-price");
const summaryCard = document.getElementById("summary-card");
const msg = document.getElementById("msg");
const SHIPPING_COST = 30;
const phoneEl = document.getElementById("phone");
function normalizePhone(v){
  const digits = String(v).replace(/[^\d]/g,'');
  if(digits.startsWith('212') && digits.length >= 12){
    return '0' + digits.slice(3,12);
  }
  if(digits.startsWith('0') && digits.length >= 10){
    return digits.slice(0,10);
  }
  return digits;
}
phoneEl.addEventListener("input", function(){
  this.value = this.value.replace(/[^\d+]/g,'').slice(0,16);
});
phoneEl.addEventListener("blur", function(){
  const n = normalizePhone(this.value);
  if(/^0\d{9}$/.test(n)){ this.value = n; document.getElementById('phone-help').style.color=''; }
  else { document.getElementById('phone-help').style.color='#ff6b6b'; }
});

if(cart.length === 0){
  summaryCard.style.display = "none";
}else{
  let sub = 0;
  summary.innerHTML = cart.map(item=>{
    const q = item.qty || 1;
    const line = item.price * q;
    sub += line;
    return `<div style="display:flex;justify-content:space-between"><span>${item.name} Ã— ${q}</span><strong>${line} MAD</strong></div>`;
  }).join("");
  document.getElementById("co-sub").innerText = sub + " MAD";
  document.getElementById("co-ship").innerText = (cart.length?SHIPPING_COST:0) + " MAD";
  totalPrice.innerText = "Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: " + (sub + (cart.length?SHIPPING_COST:0)) + " MAD";
}

// total calculation simplified to single unit

document.getElementById("checkout-form").addEventListener("submit", function(e){
e.preventDefault();

if(cart.length === 0) return;

const btn = document.getElementById("submit-btn");
btn.disabled = true;
btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...";

const now = new Date();
const dateStr = now.toLocaleString("ar-MA", {hour12:false});

// product and total (fallbacks if no cart)
const productName = (cart.length ? cart.map(i=>`${i.name}Ã—${i.qty||1}`).join(", ") : "WDZ Direct Order");
const totalValue = (cart.length ? cart.reduce((a,i)=>a+(i.price*(i.qty||1)),0) + SHIPPING_COST : 0);

const normalizedPhone = normalizePhone(document.getElementById("phone").value);
if(!/^0\d{9}$/.test(normalizedPhone)){
  msg.style.color="orange";
  msg.innerText="ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: Ø£Ø¯Ø®Ù„ 0 Ù…ØªØ¨ÙˆØ¹Ù‹Ø§ Ø¨Ù€ 9 Ø£Ø±Ù‚Ø§Ù… Ø£Ùˆ +212/212 ÙˆØ³ÙŠØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§";
  btn.disabled=false;
  btn.innerText="ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨";
  return;
}

const data = {
  name: document.getElementById("name").value,
  phone: normalizedPhone,
  city: document.getElementById("city").value,
  address: document.getElementById("address").value,
  date: dateStr,
  product: productName,
  total: totalValue
};

fetch("https://script.google.com/macros/s/AKfycbyjwMU5fAB-_EsshT0JpPqP3RdWzA3mp0KsrN0GUgkh33ujesSP1DFfylfwKSfqa1qIxQ/exec",{
method:"POST",
headers:{"Content-Type":"text/plain;charset=utf-8"},
body:JSON.stringify(data)
})
.then(res=>res.text())
.then(()=>{
localStorage.removeItem("cart");
window.location.href="thankyou.html";
})
.catch(()=>{
msg.style.color="red";
msg.innerText="Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„";
btn.disabled=false;
btn.innerText="ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨";
});
});
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "WDZâ„¢ Global Brand",
  "brand": "WDZ",
  "logo": "https://via.placeholder.com/256x256.png?text=WDZ",
  "sameAs": []
}
</script>

</body>
</html>
