<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>إتمام الطلب</title>
</head>
<body>

<h2>تفاصيل الطلب</h2>

<div id="order-info"></div>

<h3>معلومات الزبون</h3>

<form id="order-form">
  <input type="text" id="name" placeholder="الاسم الكامل" required><br><br>
  <input type="text" id="phone" placeholder="رقم الهاتف" required><br><br>
  <input type="text" id="city" placeholder="المدينة" required><br><br>
  <button type="submit">تأكيد الطلب</button>
</form>

<script>
const cart = JSON.parse(localStorage.getItem("cart")) || [];

if(cart.length === 0){
  document.body.innerHTML = "<h2>لا يوجد منتج مختار</h2>";
}else{
  document.getElementById("order-info").innerHTML =
    "<p>المنتج: " + cart[0].name + "</p>" +
    "<p>السعر: " + cart[0].price + " درهم</p>";
}

document.getElementById("order-form").addEventListener("submit", function(e){
  e.preventDefault();

  const data = {
    name: document.getElementById("name").value,
    phone: document.getElementById("phone").value,
    city: document.getElementById("city").value,
    product: cart[0].name,
    price: cart[0].price
  };

  fetch("https://script.google.com/macros/s/AKfycbyjwMU5fAB-_EsshT0JpPqP3RdWzA3mp0KsrN0GUgkh33ujesSP1DFfylfwKSfqa1qIxQ/exec", {
    method: "POST",
    body: JSON.stringify(data)
  })
  .then(res => res.text())
  .then(() => {
    localStorage.removeItem("cart");
    window.location.href = "thankyou.html";
  })
  .catch(() => {
    alert("حدث خطأ");
  });

});
</script>

</body>
</html>
